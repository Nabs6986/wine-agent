{% extends "base.html" %}

{% block title %}Notes - Wine Agent{% endblock %}

{% block content %}
<div class="page-header">
    <h1>Tasting Notes</h1>
    <a href="/inbox" class="btn btn-primary">New from Inbox</a>
</div>

<div class="filters">
    <a href="/notes?status=all" class="filter-btn {% if current_status == 'all' %}active{% endif %}">All</a>
    <a href="/notes?status=draft" class="filter-btn {% if current_status == 'draft' %}active{% endif %}">Drafts</a>
    <a href="/notes?status=published" class="filter-btn {% if current_status == 'published' %}active{% endif %}">Published</a>
</div>

{% if notes %}
<div class="notes-list">
    {% for note in notes %}
    <div class="note-item {{ note.status.value }}">
        <a href="{% if note.status.value == 'draft' %}/notes/draft/{{ note.id }}{% else %}/notes/{{ note.id }}{% endif %}">
            <div class="note-header">
                <span class="note-title">
                    {% if note.wine.producer %}{{ note.wine.producer }}{% endif %}
                    {% if note.wine.cuvee %} {{ note.wine.cuvee }}{% endif %}
                    {% if note.wine.vintage %} {{ note.wine.vintage }}{% endif %}
                    {% if not note.wine.producer and not note.wine.cuvee and not note.wine.vintage %}
                    Untitled Note
                    {% endif %}
                </span>
                <span class="status {{ note.status.value }}">{{ note.status.value }}</span>
            </div>
            <div class="note-meta">
                {% if note.wine.region or note.wine.country %}
                <span class="location">
                    {% if note.wine.region %}{{ note.wine.region }}{% endif %}
                    {% if note.wine.region and note.wine.country %}, {% endif %}
                    {% if note.wine.country %}{{ note.wine.country }}{% endif %}
                </span>
                {% endif %}
                {% if note.scores.total > 0 %}
                <span class="score">{{ note.scores.total }} pts</span>
                {% endif %}
                <span class="date">{{ note.created_at.strftime('%Y-%m-%d') }}</span>
            </div>
            {% if note.overall_notes %}
            <div class="note-preview">
                {{ note.overall_notes[:150] }}{% if note.overall_notes|length > 150 %}...{% endif %}
            </div>
            {% endif %}
        </a>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="empty-state">
    <p>No tasting notes found.</p>
    <a href="/inbox" class="btn btn-primary">Create from Inbox</a>
</div>
{% endif %}
{% endblock %}
